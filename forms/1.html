<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lọc Trang Trại</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }

        select {
            padding: 5px;
            margin-top: 10px;
        }
    </style>
</head>

<body>

    <h1>Danh Sách Trang Trại</h1>

    <label for="farm-select">Chọn Trang Trại:</label>
    <select id="farm-select" onchange="filterData()">
        <option value="">Tất cả</option>
        <!-- Các tùy chọn sẽ được tạo tự động bằng JavaScript -->
    </select>

    <table>
        <thead>
            <tr>
                <th>STT</th>
                <th>Tên Trang Trại</th>
                <th>Tên Chuồng</th>
                <th>Thời Gian</th>
            </tr>
        </thead>
        <tbody id="data-table-body">
            <!-- Dữ liệu sẽ được điền bằng JavaScript -->
        </tbody>
    </table>

    <script>
        // Bước 2: Dữ liệu mô phỏng
        const data = [
            { id: 1, farm_name: 'Trang trại A', barn_name: 'Chuồng 1', timestamp: '2024-08-16 10:00:00' },
            { id: 2, farm_name: 'Trang trại B', barn_name: 'Chuồng 2', timestamp: '2024-08-16 11:00:00' },
            { id: 3, farm_name: 'Trang trại A', barn_name: 'Chuồng 3', timestamp: '2024-08-16 12:00:00' },
            { id: 4, farm_name: 'Trang trại C', barn_name: 'Chuồng 1', timestamp: '2024-08-16 13:00:00' },
            { id: 5, farm_name: 'Trang trại B', barn_name: 'Chuồng 2', timestamp: '2024-08-16 14:00:00' },
        ];

        // Bước 3: Tạo dropdown từ dữ liệu
        function populateDropdown() {
            const select = document.getElementById('farm-select');
            const farmNames = [...new Set(data.map(item => item.farm_name))]; // Lấy danh sách các tên trang trại không trùng lặp
            farmNames.forEach(name => {
                const option = document.createElement('option');
                option.value = name;
                option.textContent = name;
                select.appendChild(option);
            });
        }

        // Bước 4: Hiển thị dữ liệu trong bảng
        function populateTable(filteredData) {
            const tbody = document.getElementById('data-table-body');
            tbody.innerHTML = ''; // Xóa bảng trước khi thêm dữ liệu mới

            filteredData.forEach((item, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${item.farm_name}</td>
                    <td>${item.barn_name}</td>
                    <td>${item.timestamp}</td>
                `;
                tbody.appendChild(row);
            });
        }

        // Bước 5: Lọc dữ liệu khi chọn trang trại
        function filterData() {
            const selectedFarm = document.getElementById('farm-select').value;
            const filteredData = selectedFarm ? data.filter(item => item.farm_name === selectedFarm) : data;
            populateTable(filteredData);
        }

        // Bước 6: Khởi tạo dropdown và bảng khi trang được tải
        populateDropdown();
        populateTable(data);
    </script>
</body>

</html>