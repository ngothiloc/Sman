<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản Lý Tin Tức</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
    <div class="container mt-5">
        <h2>Đăng Tin Tức Mới</h2>
        <form id="newsForm">
            <div class="mb-3">
                <label for="newsTitle" class="form-label">Tiêu đề tin tức</label>
                <input type="text" class="form-control" id="newsTitle" required>
            </div>
            <div class="mb-3">
                <label for="newsImage" class="form-label">Tải ảnh từ máy tính</label>
                <input type="file" class="form-control" id="newsImage" accept="image/*" required>
                <img id="imagePreview" style="max-width: 100%; margin-top: 10px; display: none;" />
            </div>
            <div class="mb-3">
                <label for="newsContent" class="form-label">Nội dung tóm gọn</label>
                <textarea class="form-control" id="newsContent" rows="3" required></textarea>
            </div>
            <button type="submit" class="btn btn-primary">Đăng Tin Tức</button>
        </form>

        <h2 class="mt-5">Danh Sách Tin Tức</h2>
        <div id="newsList" class="mt-3">
            <!-- Các tin tức sẽ được hiển thị ở đây -->
        </div>
    </div>

    <script>
        document.getElementById('newsImage').addEventListener('change', function () {
            let file = this.files[0];
            if (file) {
                let reader = new FileReader();
                reader.onload = function (e) {
                    document.getElementById('imagePreview').src = e.target.result;
                    document.getElementById('imagePreview').style.display = 'block';
                }
                reader.readAsDataURL(file);
            }
        });

        document.getElementById('newsForm').addEventListener('submit', function (event) {
            event.preventDefault();

            let title = document.getElementById('newsTitle').value;
            let image = document.getElementById('imagePreview').src;
            let content = document.getElementById('newsContent').value;

            let newsItem = { title, image, content };
            let newsList = JSON.parse(localStorage.getItem('newsList')) || [];
            newsList.push(newsItem);

            localStorage.setItem('newsList', JSON.stringify(newsList));

            alert('Tin tức đã được đăng!');
            document.getElementById('newsForm').reset();
            document.getElementById('imagePreview').style.display = 'none';

            loadNews();
        });

        function loadNews() {
            let newsList = JSON.parse(localStorage.getItem('newsList')) || [];
            let newsListContainer = document.getElementById('newsList');
            newsListContainer.innerHTML = '';

            newsList.forEach(function (newsItem, index) {
                let newsCard = document.createElement('div');
                newsCard.className = 'card mb-3';
                newsCard.innerHTML = `
                    <div class="row g-0">
                        <div class="col-md-4">
                            <img src="${newsItem.image}" class="img-fluid rounded-start" alt="...">
                        </div>
                        <div class="col-md-8">
                            <div class="card-body">
                                <h5 class="card-title">${newsItem.title}</h5>
                                <p class="card-text">${newsItem.content}</p>
                                <button class="btn btn-danger" onclick="deleteNews(${index})">Xóa</button>
                            </div>
                        </div>
                    </div>
                `;
                newsListContainer.appendChild(newsCard);
            });
        }

        function deleteNews(index) {
            let newsList = JSON.parse(localStorage.getItem('newsList')) || [];
            newsList.splice(index, 1);  // Xóa tin tức theo index
            localStorage.setItem('newsList', JSON.stringify(newsList));
            loadNews();
        }

        document.addEventListener('DOMContentLoaded', loadNews);
    </script>
</body>

</html>